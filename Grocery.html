<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retailer Data Analysis</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            background-color: #ffffff; /* White background for the entire container */
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        .input-container {
            width: 30%;
        }
        .output-container {
            width: 35%;
            display: flex;
            flex-direction: column;
        }
        .side-container {
            display: flex;
            flex-direction: column;
            width: 30%;
        }
        .heading {
            background-color: #4caf50;
            color: #ffffff;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            font-weight: bold;
        }
        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }
        .highlight {
            border-color: #81c784;
            background-color: #e8f5e9;
        }
        .result, .lcp, .ei-team {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
        }
        .result {
            background-color: #f1f8e9;
        }
        .lcp {
            background-color: #e0f7fa;
            border: 1px solid #80deea;
        }
        .ei-team {
            background-color: #e1bee7;
            border: 1px solid #ba68c8;
        }
        .btn {
            padding: 10px 20px;
            color: #ffffff;
            background-color: #388e3c;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-size: 16px;
        }
        .btn:hover {
            background-color: #2e7d32;
        }
        .red-text {
            color: #ff0000;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="input-container">
        <div class="heading">Grocery Actuation</div>
        <div class="form-group">
            <label for="dealName">Deal Name</label>
            <input type="text" id="dealName" placeholder="Enter Deal Name">
        </div>
        <div class="form-group">
            <label for="dealId">Deal ID</label>
            <input type="text" id="dealId" placeholder="Enter Deal ID">
        </div>
        <div class="form-group">
            <label for="team">Team</label>
            <input type="text" id="team" placeholder="Enter Team Name">
        </div>
        <div class="form-group">
            <label for="walletName">Wallet Name</label>
            <input type="text" id="walletName" placeholder="Enter Wallet Name">
        </div>
        <div class="form-group">
            <label for="budget">Budget</label>
            <input type="number" id="budget" placeholder="Enter Budget">
        </div>
        <div class="form-group">
            <label for="flightStartDate">Flight Start Date</label>
            <input type="text" id="flightStartDate" placeholder="Select Start Date">
        </div>
        <div class="form-group">
            <label for="flightEndDate">Flight End Date</label>
            <input type="text" id="flightEndDate" placeholder="Select End Date">
        </div>
        <div class="form-group">
            <label for="numberOfDays">Number of Days</label>
            <input type="text" id="numberOfDays" placeholder="Number of Days" readonly>
        </div>
        <div class="form-group">
            <label for="tactic">Select Tactic</label>
            <select id="tactic" onchange="updateTactic()">
                <option value="">-- Select Tactic --</option>
                <option value="SPA">SPA</option>
                <option value="BA">BA</option>
            </select>
        </div>
        <div class="form-group hidden" id="placementFields">
            <label for="kwGroupNames">KW Group Names (comma-separated)</label>
            <input type="text" id="kwGroupNames" placeholder="Enter KW Group Names">
            <label for="brand">Brand</label>
            <input type="text" id="brand" placeholder="Enter Brand">
        </div>
        <div class="form-group">
            <label for="walletCapType">Wallet Cap Type</label>
            <select id="walletCapType">
                <option value="capped">Capped</option>
                <option value="uncapped">Uncapped</option>
            </select>
        </div>
        <div class="form-group">
            <button class="btn" onclick="generateData()">Generate Data</button>
        </div>
    </div>

    <div class="output-container">
        <div class="result" id="result"></div>
    </div>

    <div class="side-container">
        <div class="lcp" id="lcp">
            <h3>LCP</h3>
            <div id="lcpResult">Your LCP result will be displayed here.</div>
            <p id="walletBalance">Wallet Balance: [Insert Wallet Balance Here]</p>
        </div>
        <div class="ei-team" id="eiTeam">
            <h3>EI Team</h3>
            <p>EI Team instructions:</p>
            <ol>
                <li>Please follow the code.</li>
                <li>CPC = [Insert CPC Here]</li>
            </ol>
            <p id="eiTeamResult">Your EI Team details will be displayed here.</p>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        flatpickr('#flightStartDate', {
            dateFormat: "m/d/Y",
            onChange: calculateDays
        });
        flatpickr('#flightEndDate', {
            dateFormat: "m/d/Y",
            onChange: calculateDays
        });
    });

    function updateTactic() {
        const tactic = document.getElementById('tactic').value;
        const placementFields = document.getElementById('placementFields');
        placementFields.classList.toggle('hidden', tactic !== 'SPA');
    }

    function calculateDays() {
        const startDate = new Date(document.getElementById('flightStartDate').value);
        const endDate = new Date(document.getElementById('flightEndDate').value);
        const numberOfDays = !isNaN(startDate) && !isNaN(endDate) ? 
            Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1 : '';
        document.getElementById('numberOfDays').value = numberOfDays;
    }

    function validateInputs() {
        let valid = true;
        const requiredFields = ['dealName', 'dealId', 'team', 'walletName', 'budget', 'flightStartDate', 'flightEndDate', 'numberOfDays'];
        requiredFields.forEach(id => {
            const input = document.getElementById(id);
            if (!input.value.trim()) {
                input.classList.add('highlight');
                valid = false;
            } else {
                input.classList.remove('highlight');
            }
        });
        return valid;
    }

    function highlightSpecialChars(text) {
        return text.replace(/[^a-zA-Z0-9_]/g, match => `<span class="red-text">${match}</span>`);
    }

    function generateData() {
        if (!validateInputs()) {
            alert('Please fill in all required fields.');
            return;
        }

        const dealName = highlightSpecialChars(document.getElementById('dealName').value.replace(/[\s/]/g, '_'));
        const dealId = document.getElementById('dealId').value;
        const team = document.getElementById('team').value;
        const walletName = highlightSpecialChars(document.getElementById('walletName').value.replace(/[\s/]/g, '_'));
        const budget = parseFloat(document.getElementById('budget').value);
        const flightStartDate = document.getElementById('flightStartDate').value;
        const flightEndDate = document.getElementById('flightEndDate').value;
        const numberOfDays = parseInt(document.getElementById('numberOfDays').value);
        const tactic = document.getElementById('tactic').value;
        const walletCapType = document.getElementById('walletCapType').value;

        const bufferMultiplier = 1.40;
        const bufferUsedText = '40%';

        let placements = '';
        if (tactic === 'SPA') {
            const kwGroupNames = document.getElementById('kwGroupNames').value.split(',').map(name => {
                return highlightSpecialChars(name.trim().replace(/[\s/]/g, '_'));
            });
            const brand = highlightSpecialChars(document.getElementById('brand').value.replace(/\s+/g, '_'));
            placements = `<ul>${kwGroupNames.map(name => `<li>KW_${name}_${brand}_${dealId}</li>`).join('')}<li>CAT_${brand}_${dealId}</li></ul>`;
        } else if (tactic === 'BA') {
            placements = `<p>ST_${dealName}_${dealId}</p>`;
        }

        const walletCap = walletCapType === 'capped' ? Math.round((budget / numberOfDays) * bufferMultiplier) : 'N/A';

        const resultHtml = `
            <p>Hi @</p>
            <p>The campaigns have been trafficked and QAed. Below are the details:</p>
            <p><strong>Details:</strong></p>
            <p>Deal Name: ${dealName}</p>
            <p>Deal ID: ${dealId}</p>
            <p>Team: ${team}</p>
            <p>Wallet Name: ${walletName}</p>
            <p>Budget: $${budget.toFixed(2)}</p>
            <p>Flight Dates: ${flightStartDate} - ${flightEndDate}</p>
            <p>Number of Days: ${numberOfDays}</p>
            ${walletCapType === 'capped' ? `<p>Buffer Used: ${bufferUsedText}</p><p>Wallet Cap: $${walletCap}</p>` : ''}
            ${placements}
        `;

        document.getElementById('result').innerHTML = resultHtml;

        const lcpResultHtml = `
            <p><strong>Details:</strong></p>
            <p>Deal Name: ${dealName}</p>
            <p>Deal ID: ${dealId}</p>
            <p>Team: ${team}</p>
            <p>Wallet Name: ${walletName}</p>
            <p>Budget: $${budget.toFixed(2)}</p>
            <p>Flight Dates: ${flightStartDate} - ${flightEndDate}</p>
            <p>Number of Days: ${numberOfDays}</p>
            ${walletCapType === 'capped' ? `<p>Buffer Used: ${bufferUsedText}</p><p>Wallet Cap: $${walletCap}</p>` : ''}
        `;
        
        document.getElementById('lcpResult').innerHTML = lcpResultHtml;
        document.getElementById('walletBalance').innerText = "Wallet Balance: [Insert Wallet Balance Here]";
        document.getElementById('eiTeamResult').innerText = "Your EI Team details will be displayed here."; // Replace with actual data
    }
</script>

</body>
</html>
