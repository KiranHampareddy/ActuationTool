<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Dollar</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
        /* Base Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* General Styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f7fafc;
            color: #333;
            padding: 20px;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        /* Centered content styles */
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            color: #333;
            letter-spacing: 1px;
        }

        /* Tactic Selection */
        select {
            padding: 12px;
            font-size: 16px;
            margin: 15px 0;
            width: 100%;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background-color: #fff;
            transition: border 0.3s ease;
        }

        select:hover,
        select:focus {
            border-color: #4A90E2;
            outline: none;
        }

        /* Input Section Styling */
        .input-section {
            display: none;
            margin-top: 20px;
            padding: 25px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .input-section.active {
            display: block;
            transform: translateY(0);
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            font-size: 14px;
            color: #4A4A4A;
        }

        input[type="text"],
        input[type="number"],
        input[type="date"],
        select {
            width: 100%;
            padding: 14px;
            margin-top: 8px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            font-size: 16px;
            background-color: #fff;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        input[type="date"]:focus,
        select:focus {
            border-color: #4A90E2;
            outline: none;
        }

        /* Error Message Styling */
        .error {
            color: #E74C3C;
            font-size: 13px;
        }

        .red-text {
            color: #E74C3C;
        }

        /* Buttons Styling */
        button {
            padding: 14px 28px;
            background-color: #4A90E2;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 25px;
            width: 100%;
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        button:hover {
            background-color: #357ABD;
            transform: translateY(-2px);
        }

        button:active {
            background-color: #2C6E9D;
        }

        /* Output Box Styling */
        #output {
            display: none;
            margin-top: 20px;
            padding: 25px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        #output h3 {
            margin-bottom: 15px;
            font-size: 1.8rem;
            color: #333;
        }

        #output_text {
            font-size: 1.2rem;
            color: #333;
        }

        /* Add smooth animation for output visibility */
        #output.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        #output.inactive {
            opacity: 0;
            transform: translateY(20px);
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Family Dollar</h1>
        <label for="tactic">Select Tactic:</label>
        <select id="tactic" onchange="showInputs()">
            <option value="">--Select Tactic--</option>
            <option value="SPA">Search</option>
            <option value="BAx">Banner X</option>
            <option value="Lockouts">Lockouts</option>
        </select>

        <div id="spa" class="input-section">
            <h3>SPA Inputs</h3>
            <div class="input-group">
                <label for="spa_deal_name">Deal Name:</label>
                <input type="text" id="spa_deal_name">
            </div>
            <div class="input-group">
                <label for="spa_deal_id">Deal ID:</label>
                <input type="text" id="spa_deal_id">
            </div>
            <div class="input-group">
                <label for="spa_additional">Additional Information:</label>
                <input type="text" id="spa_additional">
            </div>
        </div>

        <div id="bax" class="input-section">
            <h3>BAx Inputs</h3>
            <form id="placementForm">
                <div class="input-group">
                    <label for="dealName">Deal Name:</label>
                    <input type="text" id="dealName" name="dealName">
                </div>
                <div class="input-group">
                    <label for="dealId">Deal ID:</label>
                    <input type="text" id="dealId" name="dealId">
                </div>
                <div class="input-group">
                    <label for="team">Team:</label>
                    <input type="text" id="team" name="team">
                </div>
                <div class="input-group">
                    <label for="walletName">Wallet Name:</label>
                    <input type="text" id="walletName" name="walletName" oninput="updateWalletId()">
                </div>
                <div class="input-group">
                    <label for="walletId">Wallet ID:</label>
                    <input type="text" id="walletId" name="walletId" readonly>
                </div>
                <div class="input-group">
                    <label for="budget">Budget:</label>
                    <input type="number" id="budget" name="budget" step="0.01">
                </div>
                <div class="input-group">
                    <label for="appUrl">Input APP URL:</label>
                    <input type="text" id="appUrl" name="appUrl" placeholder="Enter the App URL here"
                        oninput="validateUrls()">
                    <span id="appUrlError" class="error"></span>
                </div>
                <div class="input-group">
                    <label for="webUrl">Input WEB URL:</label>
                    <input type="text" id="webUrl" name="webUrl" placeholder="Enter the Web URL here"
                        oninput="validateUrls()">
                    <span id="webUrlError" class="error"></span>
                </div>
                <div class="input-group">
                    <label for="flightStartDate">Flight Start Date:</label>
                    <input type="text" id="flightStartDate" name="flightStartDate" onchange="calculateDays()">
                </div>
                <div class="input-group">
                    <label for="flightEndDate">Flight End Date:</label>
                    <input type="text" id="flightEndDate" name="flightEndDate" onchange="calculateDays()">
                </div>
                <div class="input-group">
                    <label for="numberOfDays">Number of Days:</label>
                    <input type="number" id="numberOfDays" name="numberOfDays" readonly>
                </div>
            </form>
        </div>

        <div id="lockouts" class="input-section">
            <h3>Lockouts Inputs</h3>
            <div class="input-group">
                <label for="lockouts_deal_name">Deal Name:</label>
                <input type="text" id="lockouts_deal_name">
            </div>
            <div class="input-group">
                <label for="lockouts_deal_id">Deal ID:</label>
                <input type="text" id="lockouts_deal_id">
            </div>
            <div class="input-group">
                <label for="lockouts_reason">Lockout Reason:</label>
                <input type="text" id="lockouts_reason">
            </div>
        </div>

        <div id="output" style="margin-top: 20px;">
            <h3>Output:</h3>
            <p id="output_text"></p>
        </div>

        <button onclick="generateOutput()">Generate Output</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
        // Utility Functions
        const replaceSpaces = (input) => {
            return input.replace(/\s+/g, '_');
        };

        // Initialize Flatpickr for the date fields
        document.addEventListener("DOMContentLoaded", function () {
            flatpickr("#flightStartDate", {
                dateFormat: "m-d-Y", // Date format for the start date
                enableTime: false, // Disable time selection
            });

            flatpickr("#flightEndDate", {
                dateFormat: "m-d-y", // Date format for the end date
                enableTime: false, // Disable time selection
            });
        });

        const highlightSpecialChars = (text) => {
            return text.replace(/[^a-zA-Z0-9_]/g, match => `<span class="red-text">${match}</span>`);
        };

        const updateWalletId = () => {
            const walletName = document.getElementById('walletName').value;
            let walletId = walletName.replace(/\D/g, '').slice(0, 7).padStart(7, '0');
            document.getElementById('walletId').value = walletId;
        };

        const validateUrls = () => {
            const appUrl = document.getElementById("appUrl").value;
            const webUrl = document.getElementById("webUrl").value;

            const appUrlPattern = /^fdshop:\/\/coupon\/\d+$/;
            const webUrlPattern = /^https:\/\/www\.familydollar\.com\/coupon-details\/\d+$/;

            document.getElementById("appUrlError").textContent = !appUrlPattern.test(appUrl) ? "Invalid App URL format. Correct format: fdshop://coupon/{id}." : '';
            document.getElementById("webUrlError").textContent = !webUrlPattern.test(webUrl) ? "Invalid Web URL format. Correct format: https://www.familydollar.com/coupon-details/{id}." : '';
        };

        const calculateDays = () => {
            const start = new Date(document.getElementById("flightStartDate").value);
            const end = new Date(document.getElementById("flightEndDate").value);
            const difference = start && end ? Math.floor((end - start) / (1000 * 60 * 60 * 24) + 1) : 0;
            document.getElementById("numberOfDays").value = difference;
        };

        const showInputs = () => {
            const sections = ['spa', 'bax', 'lockouts'];
            sections.forEach(section => document.getElementById(section).style.display = 'none');

            const tactic = document.getElementById("tactic").value;
            if (tactic) {
                document.getElementById(tactic.toLowerCase()).style.display = 'block';
            }
        };

        const generateOutput = () => {
            const tactic = document.getElementById("tactic").value;
            if (!tactic) {
                alert("Please select a tactic first.");
                return;
            }

            let outputText = "";

            // SPA
            if (tactic === "SPA") {
                const dealName = document.getElementById("spa_deal_name").value;
                const dealId = document.getElementById("spa_deal_id").value;
                const additional = document.getElementById("spa_additional").value;
                if (!dealName || !dealId) {
                    alert("Please fill in all required fields for SPA.");
                    return;
                }
                outputText = `SPA Placements Ticket:
                  <br>Deal Name: ${replaceSpaces(dealName)}
                  <br>Deal ID: ${dealId}
                  <br>Additional Info: ${additional}`;
            }
            // BAx
            else if (tactic === "BAx") {
                const dealName = document.getElementById("dealName").value;
                const dealId = document.getElementById("dealId").value;
                const team = document.getElementById("team").value;
                const walletName = document.getElementById("walletName").value;
                const walletId = document.getElementById("walletId").value;
                const budget = parseFloat(document.getElementById("budget").value);
                const appUrl = document.getElementById("appUrl").value;
                const webUrl = document.getElementById("webUrl").value;
                const flightStartDate = document.getElementById("flightStartDate").value;
                const flightEndDate = document.getElementById("flightEndDate").value;
                const numberOfDays = parseInt(document.getElementById("numberOfDays").value);

                if (!dealName || !dealId || !team || !walletName || !budget || !appUrl || !webUrl || !flightStartDate || !flightEndDate) {
                    alert("Please fill in all required fields for BAx.");
                    return;
                }
                let bufferMultiplier = 1.20; // For BAx
                let pointBuffer = '20%'; // Point buffer for BAx

                const walletCap = Math.round((budget / numberOfDays) * bufferMultiplier);
                const rosBuffer = Math.round(walletCap * 0.20); // 20% buffer

                outputText = `<p>Hi @</p>
                  <p>Note:</p>
                  <p>1. </p>
                  <p>2. </p>
                  <p>The campaigns have been trafficked and QAed. Below are the details:</p>
                  <br>
                  <p><strong>BAx: </strong></p>
                  <p>Deal Name: ${highlightSpecialChars(replaceSpaces(dealName))}</p>
                  <p>Deal ID: ${dealId}</p>
                  <p>Team: ${team}</p>
                  <p>Wallet Name: ${highlightSpecialChars(replaceSpaces(walletName))} | Wallet ID: ${walletId}</p>
                  <p>Budget: $${budget.toFixed(2)}</p>
                  <p>APP URL: ${highlightSpecialChars(appUrl)}</p>
                  <p>Web URL: ${highlightSpecialChars(webUrl)}</p>
                  <p>Flight Dates: ${flightStartDate} to ${flightEndDate}</p>
                  <p>Number of Days: ${numberOfDays}</p>
                  <p>Wallet Cap: $${walletCap.toFixed(2)}</p>
                  <p>Buffer Used: ${pointBuffer}</p>
                  <br> <!-- Added line gap after Buffer Used -->

                  <p><strong>App Placements:</strong></p>
<br> <!-- Added line gap after App Placements -->

<p><strong>Product Details Page: (Product Page) (Slot: medium-banner) (CPM: $0.009)</strong></p>
<p>PDP_Med_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Run of Site: (Run of Site) (Slot: medium-banner) (CPM: $0.009)</strong></p>
<p>ROS_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Coupon Details Page: (Coupon) (Slot: medium-banner) (CPM: $0.016)</strong></p>
<p>CP_Med_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Search Results Page: (Search) (Slot: thin-banner) (CPM: $0.009)</strong></p>
<p>Search_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Sub-Category: (Category) (Slot: thin-banner) (CPM: $0.009)</strong></p>
<p>SubCAT_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Coupon Listing Page: (Coupon) (Slot: thin-banner) (CPM: $0.016)</strong></p>
<p>CP_Thin_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Product Details Page - Top: (Product Page) (Slot: pdp-pencil-banner) (CPM: $0.009)</strong></p>
<p>PDP_Pencil_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Coupon Details Page - Top: (Coupon) (Slot: pdp-pencil-banner) (CPM: $0.016)</strong></p>
<p>CP_Pencil_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Homepage - Midpage: (Homepage - App) (Slot: midpage-banner) (CPM: $0.016)</strong></p>
<p>HPApp_Mid_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Coupon Category Navigation: (Category) (Slot: coupon-navigation-banner) (CPM: $0.016)</strong></p>
<p>CP_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Category - Hero: (Category) (Slot: category-hero-banner) (CPM: $0.009)</strong></p>
<p>CAT_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<br> <!-- Line break for separation -->

<p><strong>Web Placements:</strong></p>

<br> <!-- Line break for separation -->

<p><strong>Homepage – Large 2-Across: (Homepage - Web) (Slot: 2-across-banner) (CPM: $0.016)</strong></p>
<p>HPWeb_2Across_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<p><strong>Homepage – Pencil Banner: (Homepage - Web) (Slot: pencil-banner) (CPM: $0.016)</strong></p>
<p>HPWeb_Pencil_${highlightSpecialChars(replaceSpaces(dealName))}_${dealId}</p>

<br>
<p> Thank you..!</P>`;
            }
            // Lockouts
            else if (tactic === "Lockouts") {
                const dealName = document.getElementById("lockouts_deal_name").value;
                const dealId = document.getElementById("lockouts_deal_id").value;
                const reason = document.getElementById("lockouts_reason").value;

                if (!dealName || !dealId || !reason) {
                    alert("Please fill in all required fields for Lockouts.");
                    return;
                }

                outputText = `Lockouts Ticket:
                  <br>Deal Name: ${dealName}
                  <br>Deal ID: ${dealId}
                  <br>Reason: ${reason}`;
            }

            // Output the generated text
            document.getElementById("output_text").innerHTML = outputText;

            // Show output box with animation
            const outputBox = document.getElementById("output");
            outputBox.classList.add('active');
        };
    </script>
</body>

</html>
